#include <SmearingTool.h>

// couldn't be inside class due to root feacher during TF1 creation:
Double_t DoubleGauss(Double_t*, Double_t* );

   const float SmearingTool::PTbin[14]={25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 80, 100, 150, 300};
   const float SmearingTool::ETAbin[9]={-2.1, -1.6, -1.2, -0.8, 0, 0.8, 1.2, 1.6, 2.1};

   ////// Smearing parametrization for single muon:
   const float SmearingTool::mean[104]={
                   -0.00179661, -0.00186815, -0.00215934, -0.00250491, -0.00263419, -0.00281678, -0.00308833, -0.00357978, -0.00329094, -0.00388493, -0.00463161, -0.00563645, -0.00885475, 
                   -0.000845813, -0.000749663, -0.000880891, -0.000960479, -0.000907186, -0.000966598, -0.000998797, -0.00120538, -0.00134634, -0.00110655, -0.000964708, -0.00181935, -0.00656581, 
                   0.000179075, 8.49524e-05, 1.87817e-05, 9.51995e-05, -8.92217e-05, 3.26969e-05, -0.000129266, -0.000158616, 6.08871e-05, -0.000130812, -0.000222203, 2.1495e-05, -0.000944903, 
                   0.000182597, 0.000184396, 0.000124749, 0.000190944, 0.000181066, 0.000148951, 0.000189706, 0.000283295, 0.000279403, 0.000390938, 0.000548558, 9.53022e-05, -6.51171e-05, 
                   0.000112649, 8.38908e-05, 6.22566e-05, 4.43111e-05, 6.46704e-05, 7.75671e-05, 9.53541e-05, 0.000204516, 0.000490313, 0.000286326, 0.00022777, 0.00023379, 0.00125843, 
                   -0.000138949, -0.000176553, -0.00015786, -0.000178235, -0.000251052, -0.000348503, -0.000514946, -0.000255171, -0.000416239, -0.000881593, -0.000532876, -0.000512947, 0.00148695, 
                   -0.00090231, -0.000885165, -0.000975995, -0.00109747, -0.0012886, -0.00112262, -0.00131285, -0.00141462, -0.00088468, -0.00105933, -0.000838346, -0.000588001, -0.00278488, 
                   -0.00157475, -0.00174703, -0.00211427, -0.00235548, -0.00251638, -0.00290099, -0.0027326, -0.00291001, -0.00270754, -0.00339732, -0.00398806, -0.0056444, -0.00714456};
   const float SmearingTool::sig1[104]={
                   0.0184971, 0.0189615, 0.0196422, 0.0196675, 0.0206655, 0.0211423, 0.0212618, 0.0236768, 0.0247182, 0.0283893, 0.031953, 0.0363439, 0.0486305, 
                   0.0175024, 0.017943, 0.0184138, 0.0186962, 0.0189939, 0.0198572, 0.0200694, 0.0206483, 0.0199218, 0.0234, 0.0248143, 0.0274478, 0.0381108, 
                   0.0144026, 0.0146078, 0.0151681, 0.0155832, 0.0157599, 0.0161941, 0.0168198, 0.0171013, 0.0176752, 0.0188669, 0.0200977, 0.0264391, 0.0360229, 
                   0.00982996, 0.0101533, 0.0105409, 0.0109687, 0.01134, 0.0116657, 0.0121677, 0.0127005, 0.0129618, 0.0138938, 0.0148105, 0.0162536, 0.0288148, 
                   0.00986786, 0.0101766, 0.0105728, 0.0110173, 0.0113305, 0.0117762, 0.0120476, 0.0126183, 0.0131567, 0.0137986, 0.0150222, 0.0180311, 0.0292631, 
                   0.0144973, 0.014627, 0.0150053, 0.0154648, 0.0158607, 0.0164135, 0.0168466, 0.0170768, 0.0176901, 0.0178539, 0.0203231, 0.026993, 0.0380544, 
                   0.0171146, 0.0176342, 0.0180367, 0.0183547, 0.0186765, 0.01881, 0.0201987, 0.0194912, 0.0201406, 0.0231291, 0.0245854, 0.0269802, 0.0350828, 
                   0.0185487, 0.0188703, 0.0193582, 0.0196917, 0.0204349, 0.0214744, 0.0216989, 0.0210659, 0.0219796, 0.0289999, 0.0310152, 0.0365013, 0.049212};
   const float SmearingTool::sig2[104]={
                   0.033241, 0.0348812, 0.0369427, 0.0346396, 0.0369441, 0.0370006, 0.0333409, 0.046209, 0.0531484, 3, 3, 3, 3, 
                   0.0359485, 0.0364608, 0.0374173, 0.0370606, 0.0369261, 0.0478893, 0.0377249, 0.0510981, 0.0340234, 3, 3, 3, 3, 
                   0.0310416, 0.0313679, 0.0335084, 0.0328896, 0.0315722, 0.032834, 0.0374068, 0.0334223, 0.0340625, 0.0404947, 0.0343552, 3, 3, 
                   0.0282032, 0.0293041, 0.0290305, 0.0315778, 0.0314124, 0.0302381, 0.0305279, 0.0323813, 0.0328586, 0.0354634, 0.0297109, 0.0288673, 3, 
                   0.029292, 0.0283817, 0.0292421, 0.0311735, 0.0302278, 0.0326063, 0.0300806, 0.031355, 0.0311787, 0.0394517, 0.0376087, 0.0378404, 3, 
                   0.0310331, 0.0308254, 0.030982, 0.0313315, 0.0332458, 0.0338394, 0.034898, 0.0382709, 0.0390757, 0.0353447, 0.0381239, 3, 3, 
                   0.0344384, 0.0353485, 0.0377313, 0.0374424, 0.038077, 0.0346796, 0.0538515, 0.0341275, 0.0418054, 3, 3, 3, 3, 
                   0.0357553, 0.0337569, 0.0350036, 0.0349762, 0.0364684, 0.0407647, 0.039404, 0.0381109, 0.0353125, 3, 3, 3, 3};
   const float SmearingTool::Asig2[104]={
                   0.103472, 0.0931908, 0.0884044, 0.140868, 0.119117, 0.135997, 0.283154, 0.0704451, 0.0462117, 0, 0, 0, 0, 
                   0.0389357, 0.0388091, 0.0377451, 0.0442524, 0.0485256, 0.0166197, 0.0476355, 0.0211028, 0.0881179, 0, 0, 0, 0, 
                   0.0384926, 0.0446688, 0.0368321, 0.0439605, 0.0587239, 0.0551947, 0.0396595, 0.0561732, 0.0672837, 0.033915, 0.117171, 0, 0, 
                   0.0138687, 0.013991, 0.0161827, 0.0131817, 0.0139701, 0.0172531, 0.0172897, 0.0162935, 0.0141746, 0.0169073, 0.050868, 0.177428, 0, 
                   0.0129729, 0.0157775, 0.0164245, 0.0145094, 0.0168055, 0.015131, 0.0220267, 0.022239, 0.0203863, 0.013444, 0.0240723, 0.0430989, 0, 
                   0.0411347, 0.0530387, 0.0574615, 0.0578464, 0.0536765, 0.0518764, 0.0549386, 0.0489096, 0.0559475, 0.0869278, 0.0659583, 0, 0, 
                   0.0464524, 0.0460613, 0.0426452, 0.0489292, 0.0482555, 0.0817418, 0.013799, 0.106452, 0.0405166, 0, 0, 0, 0, 
                   0.0782024, 0.118711, 0.129344, 0.155805, 0.142722, 0.10627, 0.151812, 0.253184, 0.4, 0, 0, 0, 0};

   const float SmearingTool::ERRmean[104]={
                   8.43866e-05, 7.76106e-05, 7.20237e-05, 6.46877e-05, 8.04092e-05, 0.000135262, 0.000205092, 0.00028631, 0.000370437, 0.000364563, 0.000459496, 0.000741537, 0.00253918, 
                   8.28135e-05, 7.45667e-05, 6.53226e-05, 5.78936e-05, 7.23691e-05, 0.000119038, 0.00017593, 0.00023806, 0.000300914, 0.000299687, 0.000346416, 0.00052683, 0.00161094, 
                   6.62287e-05, 5.72068e-05, 4.93074e-05, 4.6111e-05, 5.90898e-05, 9.68366e-05, 0.000142392, 0.000192956, 0.000252957, 0.000241517, 0.000297173, 0.00045138, 0.00137353, 
                   2.80489e-05, 2.40233e-05, 2.22459e-05, 2.16328e-05, 2.80423e-05, 4.60727e-05, 6.78027e-05, 9.29241e-05, 0.000117032, 0.000118621, 0.000143146, 0.000224979, 0.000709185, 
                   2.81247e-05, 2.41407e-05, 2.2326e-05, 2.18291e-05, 2.82742e-05, 4.6207e-05, 6.7792e-05, 9.41686e-05, 0.000121782, 0.00011683, 0.00014214, 0.000229823, 0.000736362, 
                   6.67216e-05, 5.78095e-05, 4.96576e-05, 4.64095e-05, 5.95273e-05, 9.83114e-05, 0.000145047, 0.000194723, 0.000255148, 0.000242988, 0.000291808, 0.000470616, 0.00146038, 
                   8.17247e-05, 7.41301e-05, 6.47671e-05, 5.74282e-05, 7.18482e-05, 0.00011883, 0.000173564, 0.000239339, 0.000296367, 0.000295868, 0.000347141, 0.000506074, 0.00147931, 
                   8.44914e-05, 7.85674e-05, 7.29583e-05, 6.57427e-05, 8.11357e-05, 0.000137588, 0.000206467, 0.000285339, 0.000377663, 0.000368238, 0.000452442, 0.000733333, 0.00275192};
   const float SmearingTool::ERRsig1[104]={
                   0.000190845, 0.000168311, 0.000152811, 0.000169161, 0.000208741, 0.000375072, 0.000882796, 0.000721471, 0.000822512, 0.000262321, 0.000339964, 0.000578034, 0.0023894, 
                   0.000125896, 0.000114082, 0.000101234, 9.70324e-05, 0.000129573, 0.000159672, 0.000358318, 0.000318264, 0.000650222, 0.00021225, 0.000245851, 0.00037703, 0.00128757, 
                   9.32999e-05, 8.08748e-05, 6.88746e-05, 6.7665e-05, 9.6333e-05, 0.000158376, 0.000198737, 0.000338627, 0.000502233, 0.000358514, 0.000888024, 0.000321709, 0.00106435, 
                   2.8701e-05, 2.4117e-05, 2.30824e-05, 2.16158e-05, 2.88415e-05, 4.98809e-05, 7.27268e-05, 0.000100549, 0.000128407, 0.000131991, 0.000211528, 0.000583252, 0.000511083, 
                   2.80551e-05, 2.551e-05, 2.3428e-05, 2.22726e-05, 2.98644e-05, 4.70152e-05, 7.7119e-05, 0.00010732, 0.000141287, 0.000119733, 0.000160943, 0.0003477, 0.00053222, 
                   9.46405e-05, 8.58861e-05, 7.60289e-05, 7.32746e-05, 9.19715e-05, 0.000156692, 0.00022487, 0.000273655, 0.000390256, 0.000467165, 0.000618081, 0.000336105, 0.00116491, 
                   0.000133178, 0.000116575, 9.76461e-05, 9.29743e-05, 0.000118709, 0.000245347, 0.000211134, 0.00057209, 0.000463365, 0.00020949, 0.000246261, 0.00036141, 0.00113265, 
                   0.000159558, 0.000183684, 0.000177224, 0.000175173, 0.00021402, 0.000343206, 0.000589961, 0.00102698, 0.000603891, 0.000265876, 0.000331743, 0.000572855, 0.00262281};
   const float SmearingTool::ERRsig2[104]={
                   0.000998952, 0.00100855, 0.00102362, 0.000724896, 0.00111717, 0.00183313, 0.00211319, 0.00861095, 0.0177624, 0, 0, 0, 0, 
                   0.00149536, 0.00140485, 0.00132291, 0.00111505, 0.00138823, 0.00575479, 0.00416055, 0.0109139, 0.00428116, 0, 0, 0, 0, 
                   0.000923625, 0.00072556, 0.000749092, 0.00064675, 0.000720248, 0.00127294, 0.00237091, 0.00276795, 0.00359577, 0.00573852, 0.00452492, 0, 0, 
                   0.000529647, 0.00044995, 0.000390558, 0.00044021, 0.000564472, 0.000834838, 0.00125007, 0.0018629, 0.00263891, 0.00258501, 0.00171181, 0.00170644, 0, 
                   0.000549507, 0.000430652, 0.000392776, 0.00042077, 0.000505611, 0.000901579, 0.00108453, 0.00154887, 0.00222562, 0.0030927, 0.00265373, 0.00408473, 0, 
                   0.000898362, 0.00066891, 0.000565408, 0.000549993, 0.000753686, 0.00136309, 0.00194726, 0.00285492, 0.00380243, 0.00287055, 0.00561325, 0, 0, 
                   0.0013101, 0.00121133, 0.00115305, 0.000985853, 0.00130383, 0.00162651, 0.0107732, 0.00306753, 0.00684469, 0, 0, 0, 0, 
                   0.00111467, 0.000874635, 0.000816581, 0.000692529, 0.000966984, 0.00228752, 0.002799, 0.00286859, 0.000661566, 0, 0, 0, 0};
   const float SmearingTool::ERRAsig2[104]={
                   0.0169342, 0.013773, 0.0116978, 0.0164666, 0.0187459, 0.0361745, 0.123012, 0.049287, 0.0454754, 0, 0, 0, 0, 
                   0.00702409, 0.00648572, 0.00570188, 0.00590562, 0.00833034, 0.00592505, 0.0246764, 0.0120199, 0.0611984, 0, 0, 0, 0, 
                   0.0050675, 0.00452423, 0.00344076, 0.00380326, 0.00637292, 0.0099073, 0.00965952, 0.0224012, 0.0346654, 0.018095, 0.0866812, 0, 0, 
                   0.000922321, 0.000744879, 0.000782788, 0.00062654, 0.000887679, 0.00179212, 0.00271411, 0.00350038, 0.00431616, 0.00441027, 0.0139945, 0.0628404, 0, 
                   0.000832028, 0.000864851, 0.000791575, 0.000678664, 0.0010272, 0.00143984, 0.00306762, 0.00419938, 0.0058741, 0.00319679, 0.00578569, 0.0188276, 0, 
                   0.00528504, 0.00517499, 0.00481322, 0.0047604, 0.00536984, 0.00933646, 0.0132499, 0.0135508, 0.0203546, 0.0323539, 0.0446884, 0, 0, 
                   0.00807881, 0.00706507, 0.00532011, 0.00545472, 0.00693637, 0.0194817, 0.00661374, 0.0526019, 0.0249911, 0, 0, 0, 0, 
                   0.0114283, 0.0167991, 0.0160125, 0.0170688, 0.0200896, 0.0264805, 0.0528739, 0.0998624, 0.353118, 0, 0, 0, 0};

   const float SmearingTool::ResRMS[104]={
                   0.0213641, 0.0218516, 0.0226537, 0.0232101, 0.0240185, 0.0246591, 0.0253828, 0.0264792, 0.0270903, 0.0283113, 0.0316279, 0.0353459, 0.0431075, 
                   0.0193417, 0.0197392, 0.0201872, 0.020609, 0.0209678, 0.0211569, 0.0218693, 0.0223566, 0.0221573, 0.0233869, 0.0247907, 0.0273905, 0.0366481, 
                   0.0162407, 0.0166964, 0.0171516, 0.0176381, 0.0180233, 0.018473, 0.0191183, 0.0192451, 0.0201147, 0.0207599, 0.0229315, 0.0264112, 0.0351226, 
                   0.0110781, 0.0114743, 0.0118969, 0.0122948, 0.012628, 0.0129788, 0.0133926, 0.0139686, 0.014073, 0.0153046, 0.0167212, 0.0199622, 0.0287028, 
                   0.0111727, 0.0115083, 0.0119677, 0.0123993, 0.0126906, 0.0132032, 0.0135538, 0.014177, 0.0144431, 0.0153298, 0.0169524, 0.0202005, 0.0291533, 
                   0.0164124, 0.0169117, 0.0173545, 0.0177428, 0.0182809, 0.0187092, 0.0193384, 0.0198994, 0.020777, 0.0211396, 0.022707, 0.0269445, 0.0367797, 
                   0.0191021, 0.0196221, 0.020166, 0.0206085, 0.0209199, 0.0214167, 0.0215336, 0.0222896, 0.0222153, 0.0231152, 0.0245748, 0.0269065, 0.0343819, 
                   0.0213976, 0.0220541, 0.0229345, 0.0236095, 0.0242355, 0.0251552, 0.0259726, 0.0269618, 0.0275607, 0.028891, 0.030789, 0.0354882, 0.0435658};
   const float SmearingTool::ErrResRMS[104]={
                   6.12125e-05, 5.63808e-05, 5.22848e-05, 4.67978e-05, 5.79654e-05, 9.72083e-05, 0.000146071, 0.000203122, 0.000261331, 0.000256276, 0.000318323, 0.000495817, 0.00139566, 
                   6.01708e-05, 5.40433e-05, 4.72414e-05, 4.18439e-05, 5.22555e-05, 8.55678e-05, 0.000126099, 0.000171659, 0.000215008, 0.000211752, 0.000244603, 0.000371024, 0.00105356, 
                   4.88345e-05, 4.23718e-05, 3.64424e-05, 3.3927e-05, 4.34159e-05, 7.11721e-05, 0.000105227, 0.000139618, 0.000184144, 0.000175253, 0.000213614, 0.000318461, 0.000924279, 
                   2.12296e-05, 1.82259e-05, 1.68003e-05, 1.63238e-05, 2.10173e-05, 3.43451e-05, 5.01535e-05, 6.87385e-05, 8.59454e-05, 8.77113e-05, 0.000104889, 0.000164377, 0.000497845, 
                   2.14064e-05, 1.82589e-05, 1.68903e-05, 1.64892e-05, 2.12024e-05, 3.47711e-05, 5.06762e-05, 7.02936e-05, 8.95791e-05, 8.74119e-05, 0.000106077, 0.000167906, 0.000516656, 
                   4.92506e-05, 4.29081e-05, 3.67731e-05, 3.41931e-05, 4.40311e-05, 7.22853e-05, 0.000106925, 0.000145131, 0.000189731, 0.000179162, 0.000210178, 0.000331664, 0.000963891, 
                   5.95049e-05, 5.38899e-05, 4.72129e-05, 4.1793e-05, 5.22548e-05, 8.60963e-05, 0.000125077, 0.000172606, 0.000214383, 0.000209053, 0.000245258, 0.000356322, 0.00100431, 
                   6.16648e-05, 5.69906e-05, 5.29998e-05, 4.76616e-05, 5.86221e-05, 9.92287e-05, 0.000148408, 0.000204069, 0.00026709, 0.000258409, 0.00031516, 0.000489783, 0.00151037};

   ////// End smearing parametrization for single muon minus:

   ////// Smearing parametrization for single muon plus:
   const float SmearingTool::meanMuPlus[104]={
                   -0.000104728, 9.57493e-05, 0.000103962, 0.000194325, 0.000342559, 0.000391994, 0.000440487, 0.000238852, 0.000961023, 0.000449606, 0.000675369, 0.000687856, 0.00679994, 
                   -0.000378962, -0.000193391, -0.000345875, -0.000175627, -0.000182527, -2.39484e-05, -0.000203969, -0.000354793, 0.000240821, -6.65759e-06, 0.000723116, 0.000848656, 0.00329121, 
                   -0.000129322, -8.1391e-05, -7.3322e-05, -9.8074e-05, -0.000157042, -0.000171585, -0.000104732, -0.000385108, 0.000513916, -0.000162261, 0.000195986, -2.18603e-05, 0.000210716, 
                   7.08853e-05, 0.000105625, 0.000105064, 3.86076e-05, 5.84464e-05, 6.51449e-05, 0.000149492, 0.00024341, 0.000211129, 8.63801e-05, 0.000300928, 0.000111027, 5.33193e-05, 
                   0.000136295, 0.000155123, 0.000126907, 0.000168653, 0.000136745, 9.35369e-05, 0.000143051, 8.6527e-05, 0.000224502, 0.00035407, 0.000239726, 0.000265816, -0.000148052, 
                   7.12399e-05, 4.80882e-05, 3.85975e-05, 0.000164498, 0.000108174, 4.73938e-05, -3.57374e-06, -0.000191622, 0.000490791, -0.000185076, 0.000582005, 0.00125316, 0.00130148, 
                   -9.97689e-05, -0.000131133, 2.57329e-05, 2.41803e-07, -7.83715e-05, 6.34002e-05, 0.000412135, 0.000164512, -9.27104e-05, 0.000573971, 0.000939481, 0.000358028, -0.0016874, 
                   -0.000184792, -6.89746e-05, 7.76021e-05, 5.68846e-05, -9.94719e-05, -5.72186e-05, -0.000148859, 0.000166969, 0.000255824, 0.000444898, 0.00113098, 0.00042524, -0.00306646};
   const float SmearingTool::sig1MuPlus[104]={
                   0.0183849, 0.0190492, 0.0194633, 0.0201036, 0.0208725, 0.0214304, 0.0202147, 0.0224944, 0.0216285, 0.0286053, 0.0304591, 0.0357698, 0.0501022, 
                   0.0174126, 0.017821, 0.0182029, 0.0187145, 0.0188734, 0.0194199, 0.0194589, 0.0203887, 0.0202747, 0.0231456, 0.0252573, 0.0278418, 0.0381697, 
                   0.0144798, 0.0145615, 0.0153758, 0.0156016, 0.0159873, 0.016472, 0.0172102, 0.0173109, 0.0184533, 0.018658, 0.0194573, 0.0264897, 0.0359908, 
                   0.00998107, 0.0103384, 0.0107266, 0.0110898, 0.0114597, 0.0118811, 0.0123642, 0.0126928, 0.0132527, 0.0139351, 0.0150454, 0.018125, 0.028858, 
                   0.00999977, 0.0103045, 0.0107678, 0.0111333, 0.0115427, 0.0119123, 0.0122448, 0.0127573, 0.0134153, 0.01394, 0.0154758, 0.0179605, 0.0288179, 
                   0.0144717, 0.014744, 0.0151479, 0.0156715, 0.0160376, 0.0164106, 0.0167037, 0.0172256, 0.0184934, 0.0181145, 0.0196715, 0.0274173, 0.0339784, 
                   0.0174556, 0.0176954, 0.0180619, 0.0183563, 0.018818, 0.0191386, 0.0198364, 0.0200535, 0.0202154, 0.0237443, 0.0247423, 0.0269811, 0.036366, 
                   0.018249, 0.0190392, 0.0195611, 0.0200743, 0.0203696, 0.0213151, 0.0214889, 0.0220593, 0.0215027, 0.0283117, 0.031007, 0.0373094, 0.0509};
   const float SmearingTool::sig2MuPlus[104]={
                   0.0345179, 0.0356449, 0.0359932, 0.0357889, 0.0381311, 0.0369865, 0.0342673, 0.0389115, 0.0374863, 3, 3, 3, 3, 
                   0.0348865, 0.0346595, 0.037804, 0.0381008, 0.0371752, 0.0394728, 0.0384777, 0.0446396, 0.0372274, 3, 3, 3, 3, 
                   0.0310941, 0.0301787, 0.0343441, 0.0330357, 0.0342272, 0.0367347, 0.0352676, 0.0313262, 0.0391109, 0.0424341, 0.0326389, 3, 3, 
                   0.0287847, 0.0288765, 0.0295629, 0.0300156, 0.0308852, 0.0321354, 0.0356716, 0.0351289, 0.032908, 0.0360186, 0.0330864, 0.0364503, 3, 
                   0.0276256, 0.0284311, 0.0306252, 0.0302607, 0.0318655, 0.0320012, 0.0323951, 0.0304768, 0.033903, 0.0331525, 0.0396704, 0.033833, 3, 
                   0.0302122, 0.0303224, 0.0317258, 0.033347, 0.0337921, 0.0331014, 0.0334196, 0.0332769, 0.0387972, 0.0341799, 0.0404686, 3, 3, 
                   0.0365068, 0.035484, 0.0386832, 0.0373739, 0.039212, 0.038126, 0.0424456, 0.0451111, 0.0348114, 3, 3, 3, 3, 
                   0.0335028, 0.0344365, 0.0365768, 0.0360953, 0.0363347, 0.0376324, 0.0351668, 0.0396281, 0.0356028, 3, 3, 3, 3};
   const float SmearingTool::Asig2MuPlus[104]={
                   0.0926415, 0.0956624, 0.110465, 0.123224, 0.105187, 0.150574, 0.319613, 0.171429, 0.310554, 0, 0, 0, 0, 
                   0.047802, 0.0485123, 0.037693, 0.0409428, 0.0480644, 0.0368465, 0.051056, 0.0343229, 0.0703694, 0, 0, 0, 0, 
                   0.0386412, 0.0494604, 0.0335465, 0.0450095, 0.0435825, 0.0376337, 0.0461892, 0.0849648, 0.0389402, 0.0434272, 0.172241, 0, 0, 
                   0.0138739, 0.0147964, 0.0148867, 0.0155381, 0.015641, 0.0143414, 0.0120751, 0.0150589, 0.0179857, 0.0157896, 0.0337722, 0.0477086, 0, 
                   0.0160178, 0.0163298, 0.0144756, 0.0161796, 0.0153588, 0.0167217, 0.0189153, 0.0237672, 0.0217971, 0.0240398, 0.0193193, 0.0627557, 0, 
                   0.0443807, 0.0514489, 0.0512583, 0.0483545, 0.0498224, 0.056893, 0.065666, 0.0726087, 0.0433162, 0.104721, 0.0806289, 0, 0, 
                   0.0377586, 0.0462634, 0.0380127, 0.0504283, 0.0399649, 0.0461424, 0.0380836, 0.0279109, 0.0890114, 0, 0, 0, 0, 
                   0.112619, 0.104044, 0.097035, 0.125286, 0.145627, 0.138696, 0.24498, 0.180693, 0.4, 0, 0, 0, 0};

   const float SmearingTool::ERRmeanMuPlus[104]={
                   8.50805e-05, 7.9541e-05, 7.38573e-05, 6.65117e-05, 8.22016e-05, 0.000141008, 0.000208832, 0.000292466, 0.000379257, 0.000383134, 0.000463226, 0.00076374, 0.00297399, 
                   8.3227e-05, 7.48083e-05, 6.51102e-05, 5.75216e-05, 7.19322e-05, 0.00011885, 0.000175242, 0.000241082, 0.000305809, 0.000298605, 0.000366661, 0.000546217, 0.00169077, 
                   6.63084e-05, 5.71767e-05, 4.94868e-05, 4.5883e-05, 5.8912e-05, 9.65226e-05, 0.000144923, 0.000197225, 0.000257985, 0.000249045, 0.000297379, 0.000476191, 0.00137201, 
                   2.8263e-05, 2.4274e-05, 2.23266e-05, 2.17674e-05, 2.829e-05, 4.62371e-05, 6.81574e-05, 9.31654e-05, 0.000121295, 0.000118284, 0.000144079, 0.000232591, 0.000750923, 
                   2.84395e-05, 2.42717e-05, 2.24275e-05, 2.19342e-05, 2.84928e-05, 4.65103e-05, 6.8527e-05, 9.42276e-05, 0.000125049, 0.000120979, 0.000144254, 0.00023187, 0.000723327, 
                   6.67214e-05, 5.7904e-05, 4.97835e-05, 4.64965e-05, 5.98271e-05, 9.75191e-05, 0.000144303, 0.000196885, 0.000257775, 0.000249436, 0.000298567, 0.000483784, 0.00134984, 
                   8.29581e-05, 7.46813e-05, 6.49298e-05, 5.73739e-05, 7.13681e-05, 0.000118049, 0.000175463, 0.000235096, 0.000308989, 0.000308336, 0.000359353, 0.000534813, 0.00162897, 
                   8.54111e-05, 7.93808e-05, 7.34024e-05, 6.66564e-05, 8.18072e-05, 0.00013935, 0.00021169, 0.000295487, 0.000385104, 0.000372232, 0.000458232, 0.000802109, 0.00300424};
   const float SmearingTool::ERRsig1MuPlus[104]={
                   0.000173414, 0.000166255, 0.000167723, 0.000164168, 0.000196454, 0.000408009, 0.000777219, 0.00100072, 0.00136894, 0.000275776, 0.000337714, 0.000589831, 0.00287785, 
                   0.000133237, 0.000124218, 0.000101751, 9.0924e-05, 0.000122751, 0.000191872, 0.000336576, 0.000412552, 0.000548315, 0.000211428, 0.000260463, 0.000391571, 0.0013513, 
                   9.13431e-05, 8.5799e-05, 6.72746e-05, 6.76855e-05, 8.40057e-05, 0.000138931, 0.000222202, 0.000406934, 0.000362851, 0.0004055, 0.000907645, 0.000339451, 0.00106267, 
                   2.89018e-05, 2.52357e-05, 2.30775e-05, 2.28088e-05, 2.96043e-05, 4.75261e-05, 6.98258e-05, 9.26937e-05, 0.00013397, 0.000129561, 0.000186247, 0.000374053, 0.0005413, 
                   3.00548e-05, 2.53278e-05, 2.28667e-05, 2.28683e-05, 2.92873e-05, 4.79048e-05, 7.46159e-05, 0.000113504, 0.000149017, 0.000149431, 0.000172075, 0.000401041, 0.000521284, 
                   9.9695e-05, 8.85823e-05, 7.44825e-05, 6.85863e-05, 9.11073e-05, 0.000159489, 0.000249018, 0.000358875, 0.000433062, 0.000517064, 0.000635574, 0.000346147, 0.00101923, 
                   0.000122575, 0.000121242, 9.6842e-05, 9.41494e-05, 0.000112105, 0.000203216, 0.000281169, 0.000309245, 0.000759411, 0.00021846, 0.000254999, 0.00038193, 0.0012683, 
                   0.00018416, 0.000175496, 0.000159741, 0.000165541, 0.000210333, 0.000364763, 0.000871795, 0.000847502, 0.000779326, 0.00026748, 0.000335617, 0.000632874, 0.00296195};
   const float SmearingTool::ERRsig2MuPlus[104]={
                   0.00101408, 0.00099429, 0.000904295, 0.000826352, 0.00121903, 0.0018481, 0.00164986, 0.004341, 0.00332715, 0, 0, 0, 0, 
                   0.00131743, 0.00122513, 0.00132651, 0.00114469, 0.00133535, 0.00280217, 0.00364884, 0.00769143, 0.00477194, 0, 0, 0, 0, 
                   0.000913801, 0.000699493, 0.000804973, 0.000635533, 0.000843565, 0.00165422, 0.00224089, 0.00239324, 0.00503707, 0.00541353, 0.00311604, 0, 0, 
                   0.00053704, 0.000450039, 0.000417611, 0.000404928, 0.000533281, 0.000936765, 0.00169225, 0.00192785, 0.00238509, 0.0027292, 0.00220199, 0.00395211, 0, 
                   0.000499379, 0.000421263, 0.000428306, 0.000397636, 0.000545038, 0.000850572, 0.00121725, 0.00154552, 0.0023003, 0.00214544, 0.00354921, 0.00319747, 0, 
                   0.00087423, 0.000704161, 0.000609114, 0.000614058, 0.000811691, 0.00127977, 0.00180069, 0.0024122, 0.00517103, 0.00271704, 0.00493209, 0, 0, 
                   0.00151757, 0.00125111, 0.00128071, 0.000968017, 0.00148982, 0.00234788, 0.00443087, 0.00689156, 0.00497859, 0, 0, 0, 0, 
                   0.0008993, 0.000962437, 0.000976297, 0.000819782, 0.000934112, 0.00180883, 0.00242376, 0.00359278, 0.00108875, 0, 0, 0, 0};
   const float SmearingTool::ERRAsig2MuPlus[104]={
                   0.0135859, 0.0131274, 0.0139178, 0.0151467, 0.016433, 0.0414322, 0.0954419, 0.0993734, 0.289759, 0, 0, 0, 0, 
                   0.00817186, 0.00808232, 0.00550256, 0.00516652, 0.0076777, 0.0107497, 0.0211063, 0.020349, 0.042124, 0, 0, 0, 0, 
                   0.00500348, 0.00531573, 0.00320784, 0.00378894, 0.00453179, 0.00666208, 0.0128161, 0.0353639, 0.0192972, 0.0191932, 0.0996841, 0, 0, 
                   0.000909618, 0.000828675, 0.000756743, 0.00076268, 0.000976232, 0.00148562, 0.00187273, 0.00271715, 0.00492386, 0.00420166, 0.00933927, 0.0225292, 0, 
                   0.00105688, 0.000873226, 0.00070319, 0.000764697, 0.000917361, 0.00156868, 0.00255164, 0.00486866, 0.00547694, 0.0061338, 0.00573495, 0.0290459, 0, 
                   0.00594796, 0.00558453, 0.00441825, 0.00384303, 0.00520459, 0.0101679, 0.0164626, 0.0255871, 0.0233512, 0.0412748, 0.0395147, 0, 0, 
                   0.00658621, 0.00733158, 0.00494916, 0.00555772, 0.00608789, 0.0122852, 0.0145111, 0.0137256, 0.0692836, 0, 0, 0, 0, 
                   0.0158811, 0.015307, 0.0125923, 0.0149159, 0.0198896, 0.034724, 0.106728, 0.0803811, 0.389998, 0, 0, 0, 0};

   const float SmearingTool::ResRMSMuPlus[104]={
                   0.0213861, 0.022158, 0.0228641, 0.0234571, 0.0241286, 0.0250866, 0.0257516, 0.0266144, 0.02765, 0.028494, 0.0302743, 0.034954, 0.0439641, 
                   0.0194504, 0.0197283, 0.0200809, 0.0206457, 0.0209062, 0.0211941, 0.0216636, 0.0224092, 0.0226163, 0.0231121, 0.0252292, 0.0277794, 0.0368129, 
                   0.0163085, 0.0166002, 0.0172783, 0.0177223, 0.0181621, 0.0186611, 0.0193137, 0.0196788, 0.0204973, 0.0213639, 0.0229423, 0.0264572, 0.0351104, 
                   0.011266, 0.0116186, 0.0120051, 0.0123862, 0.0127917, 0.0131589, 0.0137086, 0.0141872, 0.0145859, 0.0153121, 0.016846, 0.0202131, 0.0287699, 
                   0.0112878, 0.0116511, 0.0121426, 0.0125021, 0.0129515, 0.0133585, 0.0138253, 0.0142367, 0.0151011, 0.0155235, 0.0171816, 0.0201232, 0.0287421, 
                   0.0163607, 0.0168251, 0.0173916, 0.0179701, 0.0183662, 0.0187352, 0.0192824, 0.0197899, 0.0206879, 0.0214308, 0.0232638, 0.0273683, 0.0334699, 
                   0.019339, 0.0196955, 0.0201209, 0.0206595, 0.0208431, 0.0211628, 0.0219395, 0.021852, 0.0225477, 0.0237311, 0.0247233, 0.0269232, 0.0354434, 
                   0.0214934, 0.0220336, 0.0227477, 0.0235715, 0.0242228, 0.024992, 0.0258496, 0.0267653, 0.0275651, 0.0282323, 0.03077, 0.0361651, 0.0443982};
   const float SmearingTool::ErrResRMSMuPlus[104]={
                   6.19791e-05, 5.77797e-05, 5.36512e-05, 4.79851e-05, 5.9155e-05, 0.000101005, 0.000150248, 0.000207862, 0.000271706, 0.000269027, 0.000323609, 0.000515705, 0.00160534, 
                   6.05516e-05, 5.4146e-05, 4.72301e-05, 4.16254e-05, 5.20292e-05, 8.56022e-05, 0.000126833, 0.000174076, 0.000220126, 0.000210808, 0.000258819, 0.000384492, 0.00111198, 
                   4.88678e-05, 4.21402e-05, 3.65089e-05, 3.38192e-05, 4.34607e-05, 7.12451e-05, 0.000105784, 0.000142999, 0.000187693, 0.000183383, 0.000214367, 0.000335898, 0.000923957, 
                   2.14108e-05, 1.83029e-05, 1.67811e-05, 1.63148e-05, 2.11911e-05, 3.44972e-05, 5.10217e-05, 6.98955e-05, 8.95871e-05, 8.74446e-05, 0.000105977, 0.000168712, 0.000527555, 
                   2.14742e-05, 1.83515e-05, 1.69676e-05, 1.64984e-05, 2.14403e-05, 3.492e-05, 5.15015e-05, 6.98565e-05, 9.33237e-05, 8.93959e-05, 0.000106828, 0.000168149, 0.000508411, 
                   4.90782e-05, 4.26859e-05, 3.68012e-05, 3.43976e-05, 4.41418e-05, 7.15596e-05, 0.000106092, 0.000143579, 0.000186932, 0.000182577, 0.000218789, 0.000340827, 0.000925445, 
                   6.03955e-05, 5.42335e-05, 4.73791e-05, 4.18202e-05, 5.17986e-05, 8.51183e-05, 0.000127088, 0.000169994, 0.000221248, 0.000217854, 0.000253789, 0.000376778, 0.00109381, 
                   6.23436e-05, 5.75371e-05, 5.332e-05, 4.82117e-05, 5.91544e-05, 0.000100123, 0.000150902, 0.000212049, 0.000273391, 0.000261747, 0.000319241, 0.000533226, 0.00161262};

   ////// End smearing parametrization for single muon plus:

SmearingTool::SmearingTool(){
}
float SmearingTool::PTsmear(float PTmuonGen, float ETAmuonGen, float CHARGEmuonGen, float PTmuonReco, int Ismear, TString ParVar,float ParSig){
   //Ismear = 1 - Smear with RND (no RECO use), Ismear = 2 - Smear with SF for RECO and GEN
   if(Ismear != 1 && Ismear != 2)std::cout << "ERROR SmearingTool::PTsmear: set Ismear to 1 or 2 for smearing" << std::endl;
   const int NPThist = (sizeof(PTbin)/sizeof(float)-1);
   const int NETAhist = (sizeof(ETAbin)/sizeof(float)-1);
   //const int Nhist = NPThist*NETAhist;
   ////// Make smearing for single muon from Gen level PostFSR:
   float PTmuonSmear = -10.;
   float meanVar = 0;
   float sigVar = 0;//for sig1 and sig2
   float Asig2Var = 0;
   if(ParVar == "mean")meanVar = ParSig;
   if(ParVar == "sig1" || ParVar == "sig2")sigVar = ParSig;
   if(ParVar == "Asig2Var")Asig2Var = ParSig;
   int iK_cand = -1;
   for(int iPT = 0; iPT < NPThist; iPT++){
   for(int iETA = 0; iETA < NETAhist; iETA++){
      int iK = iPT + iETA*NPThist;
      // smear muons which out of range PT and ETA
      float PTcutDown = PTbin[iPT];
      float PTcutUp = PTbin[iPT+1];
      if(iPT == 0 && PTmuonGen < PTbin[0])PTcutDown = PTmuonGen-0.001;
      if(iPT == (NPThist-1) && PTmuonGen > PTbin[NPThist])PTcutUp = PTmuonGen+0.001;
      float ETAcutDown = ETAbin[iETA];
      float ETAcutUp = ETAbin[iETA+1];
      if(iETA == 0 && ETAmuonGen < ETAbin[0])ETAcutDown = ETAmuonGen-0.001;
      if(iETA == (NETAhist-1) && ETAmuonGen >= ETAbin[NETAhist])ETAcutUp = ETAmuonGen+0.001;
      if(PTmuonGen >= PTcutDown && PTmuonGen < PTcutUp
      && ETAmuonGen >= ETAcutDown && ETAmuonGen < ETAcutUp) iK_cand = iK;
   }}

   ///// Set Scale Factor
   float ScaleFactor = 1.;
   if (fabs(ETAmuonGen) < 0.8) ScaleFactor = 1.11;
   if (fabs(ETAmuonGen) >= 0.8 && fabs(ETAmuonGen) < 1.2) ScaleFactor = 1.13;
   if (fabs(ETAmuonGen) >= 1.2) ScaleFactor = 1.08;
   TF1* fitDoubleGauss = new TF1("fitDoubleGauss", DoubleGauss, -0.1, 0.1, 5);
   fitDoubleGauss->SetParameter(4,1.);
   if(iK_cand > -1 && Ismear == 1 && CHARGEmuonGen < 0){
      float meanCorr = mean[iK_cand] + meanVar*ERRmean[iK_cand];
      float sig1Corr = sig1[iK_cand] + sigVar*ERRsig1[iK_cand];
      if(sig1Corr < 0.005) sig1Corr = 0.005;
      float sig2Corr = sig2[iK_cand] + sigVar*ERRsig2[iK_cand];
      if(sig2Corr < 0.005) sig2Corr = 0.005;
      float Asig2Corr = Asig2[iK_cand] + Asig2Var*ERRAsig2[iK_cand];
      if(Asig2Corr < 0.) Asig2Corr = 0.;
      fitDoubleGauss->SetParameter(0,meanCorr);
      fitDoubleGauss->SetParameter(1,ScaleFactor*sig1Corr);
      fitDoubleGauss->SetParameter(2,Asig2Corr);
      fitDoubleGauss->SetParameter(3,ScaleFactor*sig2Corr);
      Double_t resSim = fitDoubleGauss->GetRandom();
      PTmuonSmear = PTmuonGen*(1+resSim);
   }
   if(iK_cand > -1 && Ismear == 1 && CHARGEmuonGen > 0){
      float meanCorr = meanMuPlus[iK_cand] + meanVar*ERRmeanMuPlus[iK_cand];
      float sig1Corr = sig1MuPlus[iK_cand] + sigVar*ERRsig1MuPlus[iK_cand];
      if(sig1Corr < 0.005) sig1Corr = 0.005;
      float sig2Corr = sig2MuPlus[iK_cand] + sigVar*ERRsig2MuPlus[iK_cand];
      if(sig2Corr < 0.005) sig2Corr = 0.005;
      float Asig2Corr = Asig2MuPlus[iK_cand] + Asig2Var*ERRAsig2MuPlus[iK_cand];
      if(Asig2Corr < 0.) Asig2Corr = 0.;
      fitDoubleGauss->SetParameter(0,meanCorr);
      fitDoubleGauss->SetParameter(1,ScaleFactor*sig1Corr);
      fitDoubleGauss->SetParameter(2,Asig2Corr);
      fitDoubleGauss->SetParameter(3,ScaleFactor*sig2Corr);
      Double_t resSim = fitDoubleGauss->GetRandom();
      PTmuonSmear = PTmuonGen*(1+resSim);
   }
   delete fitDoubleGauss;
   if(iK_cand > -1 && Ismear == 2){
      PTmuonSmear = PTmuonGen + ScaleFactor*(PTmuonReco - PTmuonGen);
   }
   ////// End Smearing parametrization for single muon:

   return PTmuonSmear;
 }//end PTsmear function

   Double_t DoubleGauss(Double_t *x, Double_t *par)
   {
       double dgauss = 0.;
        if(par[1] < par[3]){//not normalized gauss both gauss are  = 1 at x[0]=par[0]
                  dgauss =  exp(-0.5*(x[0]-par[0])*(x[0]-par[0])/par[1]/par[1]);
                  dgauss = dgauss + par[2]*exp(-0.5*(x[0]-par[0])*(x[0]-par[0])/par[3]/par[3]);
                  dgauss = par[4]*dgauss;
        }
       return dgauss;
   }
