#include <SmearingTool.h>

// couldn't be inside class due to root feacher during TF1 creation:
Double_t DoubleGauss(Double_t*, Double_t* );

   const float SmearingTool::PTbin[14]={25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 80, 100, 150, 300};
   const float SmearingTool::ETAbin[9]={-2.1, -1.6, -1.2, -0.8, 0, 0.8, 1.2, 1.6, 2.1};

   ////// Smearing parametrization for single muon:
   const float SmearingTool::mean[104]={
                   -0.00162326, -0.00147067, -0.00153289, -0.00164777, -0.00156567, -0.00153236, -0.00158239, -0.00182777, -0.00130764, -0.00166823, -0.00183844, -0.00156273, -0.000396581, 
                   -0.00066498, -0.000356434, -0.000250963, -0.000124291, 0.000146005, 0.000332757, 0.000556033, 0.000550972, 0.000587811, 0.0010619, 0.0019495, 0.00234768, 0.000641749, 
                   5.67142e-05, 0.000116947, 0.000225074, 0.000476517, 0.000470958, 0.000758246, 0.000782387, 0.000918777, 0.00127849, 0.00132316, 0.0017163, 0.00296977, 0.00401037, 
                   -0.000431116, -0.000333572, -0.000298842, -0.000135588, -5.7285e-05, -3.17181e-06, 0.000154923, 0.000233605, 0.000418594, 0.00057649, 0.00106232, 0.0010781, 0.00168586, 
                   -0.00107725, -0.00112172, -0.00118028, -0.00122164, -0.00122177, -0.00121202, -0.00125117, -0.00114302, -0.00091061, -0.00118375, -0.00128963, -0.00122253, -0.000184143, 
                   -0.00179786, -0.00193719, -0.00203866, -0.00215126, -0.00233193, -0.00248022, -0.00282794, -0.00268957, -0.00292714, -0.00340945, -0.00340097, -0.00407264, -0.00420793, 
                   -0.00285739, -0.00295778, -0.00322224, -0.0034922, -0.00383681, -0.00377153, -0.00417061, -0.00445211, -0.00404435, -0.00456307, -0.00468214, -0.00530441, -0.00883109, 
                   -0.00297127, -0.00321744, -0.00364553, -0.00395855, -0.00416841, -0.00460068, -0.00449737, -0.00473023, -0.00457565, -0.0053045, -0.00601153, -0.00796848, -0.01097};
   const float SmearingTool::sig1[104]={
                   0.0185332, 0.0189981, 0.019676, 0.019639, 0.0206176, 0.0211453, 0.0212616, 0.0237063, 0.0244069, 0.0286081, 0.0320984, 0.0363835, 0.0494795, 
                   0.0174538, 0.0179144, 0.0183692, 0.0185587, 0.0188855, 0.0196527, 0.0199162, 0.0204194, 0.0198469, 0.0233737, 0.0245213, 0.0271489, 0.0370359, 
                   0.0143698, 0.0145368, 0.0150711, 0.0154794, 0.0157221, 0.0158794, 0.0165325, 0.0168501, 0.0175748, 0.0184553, 0.0189222, 0.0259027, 0.0358273, 
                   0.00975946, 0.0100492, 0.0104081, 0.0108016, 0.0111517, 0.0114635, 0.0119541, 0.0124458, 0.0126866, 0.0135035, 0.0144123, 0.0156052, 0.0273295, 
                   0.00978269, 0.0100661, 0.0104452, 0.0108515, 0.0111694, 0.0115221, 0.0118952, 0.0123651, 0.0129988, 0.0134534, 0.0146555, 0.0172224, 0.0272579, 
                   0.0143989, 0.0144986, 0.0148996, 0.0153222, 0.0156269, 0.0161837, 0.0165645, 0.0166787, 0.0171659, 0.0176444, 0.0194814, 0.026402, 0.0366608, 
                   0.0170765, 0.0176342, 0.0179208, 0.0182777, 0.0185903, 0.0187386, 0.0198751, 0.0193709, 0.019902, 0.0227959, 0.0242114, 0.0266372, 0.0350821, 
                   0.0186004, 0.0190279, 0.01945, 0.0198402, 0.0207391, 0.02186, 0.0217763, 0.020788, 0.0233159, 0.0294637, 0.0313758, 0.0373135, 0.0523232};
   const float SmearingTool::sig2[104]={
                   0.0333349, 0.0349264, 0.0368486, 0.0342994, 0.0363852, 0.0365566, 0.033185, 0.0452119, 0.0436569, 3, 3, 3, 3, 
                   0.0353573, 0.0362267, 0.0369284, 0.0357721, 0.0363446, 0.042869, 0.0375443, 0.0449099, 0.0352348, 3, 3, 3, 3, 
                   0.0308885, 0.0313223, 0.0333179, 0.0327783, 0.0319559, 0.0315575, 0.0352226, 0.0330336, 0.0337486, 0.0395457, 0.0319962, 3, 3, 
                   0.0281795, 0.0290347, 0.0286887, 0.0309781, 0.030819, 0.0305969, 0.0312185, 0.0328326, 0.0322493, 0.0350344, 0.030038, 0.0290938, 3, 
                   0.0289845, 0.0279219, 0.0291957, 0.030897, 0.030297, 0.0310877, 0.0312205, 0.0312636, 0.0314119, 0.0382702, 0.0386665, 0.038529, 3, 
                   0.0305772, 0.0308053, 0.0311422, 0.0312661, 0.0327549, 0.0337511, 0.0346415, 0.0366751, 0.0366427, 0.0360887, 0.036042, 3, 3, 
                   0.0348099, 0.0365142, 0.0372428, 0.0379521, 0.0385494, 0.0345506, 0.0490624, 0.0352387, 0.0400817, 3, 3, 3, 3, 
                   0.0357697, 0.0344048, 0.0347796, 0.0352119, 0.0373193, 0.0423854, 0.0383495, 0.0371352, 0.0384963, 3, 3, 3, 3};
   const float SmearingTool::Asig2[104]={
                   0.102845, 0.0936614, 0.0900808, 0.150995, 0.131186, 0.147199, 0.300293, 0.0774213, 0.0887204, 0, 0, 0, 0, 
                   0.04158, 0.0400608, 0.039397, 0.051589, 0.0523991, 0.0236227, 0.049817, 0.0300535, 0.0792869, 0, 0, 0, 0, 
                   0.0389687, 0.04482, 0.037586, 0.0440261, 0.0549477, 0.0665849, 0.0487573, 0.05812, 0.065336, 0.0375982, 0.179524, 0, 0, 
                   0.0138284, 0.0142874, 0.016794, 0.0138999, 0.014832, 0.0164631, 0.0158518, 0.0152408, 0.0147201, 0.0174938, 0.0473007, 0.15881, 0, 
                   0.013373, 0.0164463, 0.0161977, 0.014817, 0.0163448, 0.0170931, 0.0191829, 0.0223484, 0.0171119, 0.0144596, 0.0206625, 0.0422475, 0, 
                   0.0424781, 0.0525218, 0.0547133, 0.057124, 0.0553405, 0.0513509, 0.0561217, 0.0570448, 0.0675624, 0.0751886, 0.0876434, 0, 0, 
                   0.0434375, 0.0395117, 0.0436723, 0.0452804, 0.0447325, 0.0774729, 0.0178949, 0.0917794, 0.0454673, 0, 0, 0, 0, 
                   0.0784417, 0.109463, 0.134742, 0.154892, 0.129281, 0.0922041, 0.17527, 0.307865, 0.242592, 0, 0, 0, 0};

   const float SmearingTool::ERRmean[104]={
                   8.45414e-05, 7.77921e-05, 7.21896e-05, 6.48669e-05, 8.06425e-05, 0.000135774, 0.000205737, 0.000287364, 0.000371434, 0.000367296, 0.000461482, 0.00074186, 0.00256571, 
                   8.27688e-05, 7.45421e-05, 6.52327e-05, 5.77727e-05, 7.2204e-05, 0.00011859, 0.000175116, 0.00023713, 0.000299847, 0.000299299, 0.000342403, 0.000521171, 0.00155029, 
                   6.61499e-05, 5.69814e-05, 4.90618e-05, 4.58399e-05, 5.88132e-05, 9.599e-05, 0.000141181, 0.000190807, 0.000250783, 0.000237551, 0.00029079, 0.000442255, 0.00136536, 
                   2.78664e-05, 2.38049e-05, 2.20111e-05, 2.13492e-05, 2.76468e-05, 4.52812e-05, 6.65516e-05, 9.10433e-05, 0.000114774, 0.000115604, 0.000139623, 0.000216942, 0.000672419, 
                   2.79203e-05, 2.39159e-05, 2.20569e-05, 2.15286e-05, 2.78717e-05, 4.53767e-05, 6.67289e-05, 9.24398e-05, 0.000119598, 0.000114254, 0.000138139, 0.000221412, 0.000683922, 
                   6.63455e-05, 5.7348e-05, 4.92262e-05, 4.59932e-05, 5.87803e-05, 9.70505e-05, 0.000143027, 0.000191963, 0.000249816, 0.000238698, 0.000285361, 0.000460136, 0.00139533, 
                   8.13837e-05, 7.37771e-05, 6.43883e-05, 5.70364e-05, 7.13361e-05, 0.000117831, 0.000171744, 0.000237189, 0.000293701, 0.000291558, 0.000341961, 0.0004995, 0.00148358, 
                   8.47454e-05, 7.8916e-05, 7.34009e-05, 6.62336e-05, 8.18115e-05, 0.000139001, 0.000208531, 0.000287759, 0.000384432, 0.000374542, 0.000458719, 0.000754839, 0.00307299};
   const float SmearingTool::ERRsig1[104]={
                   0.000191036, 0.000169739, 0.000154876, 0.000175035, 0.000215879, 0.000392279, 0.000911656, 0.000784153, 0.00106836, 0.000264421, 0.000341482, 0.000577786, 0.0024729, 
                   0.000128096, 0.000115125, 0.000101997, 0.000100318, 0.000132032, 0.000172672, 0.000350406, 0.000343922, 0.000605145, 0.00021197, 0.000242892, 0.00037254, 0.00121833, 
                   9.39153e-05, 8.05015e-05, 6.78549e-05, 6.71846e-05, 9.35065e-05, 0.000163916, 0.000208233, 0.000335941, 0.000463459, 0.000341828, 0.000859892, 0.000314784, 0.00105608, 
                   2.85206e-05, 2.40598e-05, 2.31668e-05, 2.15046e-05, 2.8729e-05, 4.81545e-05, 6.97112e-05, 9.59552e-05, 0.000127841, 0.000129678, 0.000200073, 0.000482329, 0.000480955, 
                   2.79123e-05, 2.54661e-05, 2.2989e-05, 2.19936e-05, 2.92988e-05, 4.72398e-05, 7.2375e-05, 0.000105011, 0.00013238, 0.000120534, 0.000150063, 0.000347771, 0.000488958, 
                   9.53321e-05, 8.41028e-05, 7.34313e-05, 7.21346e-05, 9.11588e-05, 0.000153569, 0.000218964, 0.000280591, 0.000377678, 0.000434886, 0.000589538, 0.00032814, 0.00109161, 
                   0.000131102, 0.000110369, 9.74047e-05, 8.96968e-05, 0.000114159, 0.000237388, 0.000218633, 0.000517802, 0.000471434, 0.000206434, 0.000242556, 0.000356702, 0.00114045, 
                   0.000159776, 0.000179217, 0.000183695, 0.000177159, 0.000210482, 0.000341145, 0.000616963, 0.00104409, 0.00216534, 0.000271549, 0.000337906, 0.000597025, 0.00304495};
   const float SmearingTool::ERRsig2[104]={
                   0.00100765, 0.00101313, 0.00102045, 0.000701994, 0.00105049, 0.00177381, 0.00206945, 0.00842794, 0.0100917, 0, 0, 0, 0, 
                   0.00142518, 0.00137268, 0.00127337, 0.000988583, 0.00130487, 0.00400968, 0.00385955, 0.00725741, 0.00441324, 0, 0, 0, 0, 
                   0.000919205, 0.00071785, 0.000723886, 0.000637778, 0.000739589, 0.00110126, 0.00199151, 0.00263028, 0.00339578, 0.00483059, 0.00282008, 0, 0, 
                   0.000526886, 0.000440319, 0.000379472, 0.000416847, 0.000532724, 0.0008326, 0.00127367, 0.00187657, 0.00251177, 0.00242419, 0.00169136, 0.00154525, 0, 
                   0.000533565, 0.00041591, 0.000389236, 0.00040671, 0.000504929, 0.000805515, 0.00114235, 0.00149047, 0.00238524, 0.00280832, 0.00282833, 0.00402584, 0, 
                   0.000876506, 0.000658576, 0.000568053, 0.000544176, 0.000720816, 0.00133239, 0.00184072, 0.00246242, 0.00295223, 0.00300318, 0.00393325, 0, 0, 
                   0.00136556, 0.00132962, 0.00111322, 0.00101906, 0.00134179, 0.00164983, 0.0076364, 0.0031607, 0.00599146, 0, 0, 0, 0, 
                   0.00111702, 0.000928569, 0.000815716, 0.000709648, 0.00106512, 0.00269405, 0.00254502, 0.00239865, 0.00675804, 0, 0, 0, 0};
   const float SmearingTool::ERRAsig2[104]={
                   0.0168831, 0.0139024, 0.0120089, 0.0176732, 0.020378, 0.0395705, 0.127856, 0.0567315, 0.0874185, 0, 0, 0, 0, 
                   0.00744643, 0.00664761, 0.00591732, 0.00667047, 0.00879089, 0.00793177, 0.0240409, 0.0162425, 0.0509829, 0, 0, 0, 0, 
                   0.00515955, 0.0044845, 0.00340715, 0.00376261, 0.00591777, 0.0111953, 0.0114819, 0.0223456, 0.0320547, 0.0175086, 0.095944, 0, 0, 
                   0.000911959, 0.00075274, 0.000801652, 0.000642604, 0.000912276, 0.0016382, 0.00238202, 0.00313973, 0.00438385, 0.00431016, 0.0121709, 0.0464554, 0, 
                   0.000842557, 0.000890324, 0.000767633, 0.000673529, 0.000983134, 0.00157844, 0.00256318, 0.00401395, 0.00514403, 0.00331966, 0.00484569, 0.016833, 0, 
                   0.00547991, 0.00499542, 0.00449932, 0.00462706, 0.0054024, 0.00896196, 0.0127804, 0.0149418, 0.0217916, 0.0272607, 0.046469, 0, 0, 
                   0.00764936, 0.00608841, 0.00541043, 0.00500285, 0.00635724, 0.0187595, 0.00782553, 0.0420696, 0.0273563, 0, 0, 0, 0, 
                   0.0115011, 0.0156635, 0.0171511, 0.017215, 0.0189365, 0.0245154, 0.0610258, 0.107458, 0.305328, 0, 0, 0, 0};

   const float SmearingTool::ResRMS[104]={
                   0.021397, 0.0218951, 0.0226998, 0.0232701, 0.0240823, 0.0247343, 0.0254796, 0.0265868, 0.0271308, 0.0285072, 0.0317751, 0.0354678, 0.0438123, 
                   0.0193148, 0.0197363, 0.0201546, 0.0205644, 0.0209235, 0.0210832, 0.0217917, 0.0222385, 0.0221564, 0.0233654, 0.0245085, 0.0271044, 0.0359666, 
                   0.0162036, 0.0166487, 0.01709, 0.0175511, 0.017949, 0.0183387, 0.0189395, 0.0190666, 0.0199153, 0.0205073, 0.0225375, 0.0258346, 0.0349918, 
                   0.0110199, 0.011383, 0.0117982, 0.0121614, 0.0124834, 0.0128124, 0.0132221, 0.01374, 0.0138287, 0.0149953, 0.0163936, 0.0194677, 0.0272498, 
                   0.0111029, 0.0114133, 0.0118541, 0.0122682, 0.0125506, 0.0129741, 0.0134184, 0.0139734, 0.0141465, 0.0150537, 0.0165585, 0.0197071, 0.0272025, 
                   0.0163106, 0.0168082, 0.0172264, 0.0176065, 0.0180895, 0.0185128, 0.0191327, 0.0196844, 0.0204068, 0.0208145, 0.0223054, 0.0263664, 0.0356284, 
                   0.0190299, 0.0195402, 0.0200469, 0.020488, 0.0207809, 0.021213, 0.021331, 0.0221492, 0.0219853, 0.022788, 0.0241878, 0.0265751, 0.0342628, 
                   0.021437, 0.0221329, 0.0230194, 0.0237433, 0.0243753, 0.0253336, 0.026124, 0.027142, 0.0279024, 0.029317, 0.0310957, 0.0360651, 0.0447797};
   const float SmearingTool::ErrResRMS[104]={
                   6.13186e-05, 5.65006e-05, 5.23931e-05, 4.69195e-05, 5.81196e-05, 9.75017e-05, 0.000146614, 0.0002039, 0.00026177, 0.000257986, 0.000319837, 0.000498214, 0.00141997, 
                   6.01033e-05, 5.40431e-05, 4.71675e-05, 4.17561e-05, 5.21469e-05, 8.52669e-05, 0.000125622, 0.000170743, 0.000214918, 0.000211523, 0.000241889, 0.000367283, 0.00103397, 
                   4.87399e-05, 4.22544e-05, 3.63131e-05, 3.37602e-05, 4.32384e-05, 7.06526e-05, 0.000104259, 0.000138324, 0.000182364, 0.00017312, 0.000210036, 0.0003116, 0.000920199, 
                   2.11239e-05, 1.80826e-05, 1.66606e-05, 1.6147e-05, 2.07758e-05, 3.39012e-05, 4.95032e-05, 6.76167e-05, 8.44503e-05, 8.59334e-05, 0.00010283, 0.000160316, 0.000473212, 
                   2.12782e-05, 1.81102e-05, 1.67303e-05, 1.6315e-05, 2.09685e-05, 3.41652e-05, 5.01617e-05, 6.92719e-05, 8.77329e-05, 8.58269e-05, 0.000103616, 0.000163794, 0.000481782, 
                   4.89626e-05, 4.2654e-05, 3.65034e-05, 3.39297e-05, 4.35698e-05, 7.15191e-05, 0.000105746, 0.000143548, 0.000186396, 0.000176394, 0.000206461, 0.000324499, 0.000931799, 
                   5.92963e-05, 5.36697e-05, 4.69367e-05, 4.15489e-05, 5.19063e-05, 8.528e-05, 0.000123871, 0.000171386, 0.000212184, 0.000206059, 0.000241468, 0.00035181, 0.000999123, 
                   6.17943e-05, 5.72042e-05, 5.31982e-05, 4.79328e-05, 5.89647e-05, 9.99326e-05, 0.000149268, 0.000205409, 0.000270375, 0.000262219, 0.000318499, 0.000497651, 0.00155433};

   ////// End smearing parametrization for single muon minus:

   ////// Smearing parametrization for single muon plus:
   const float SmearingTool::meanMuPlus[104]={
                   -0.00245624, -0.00247902, -0.00270368, -0.00284331, -0.00289697, -0.00308285, -0.00328272, -0.00371864, -0.0032623, -0.00395094, -0.00436368, -0.00546784, -0.00191209, 
                   -0.00272239, -0.00277205, -0.00314987, -0.00320837, -0.00341721, -0.00348298, -0.00386739, -0.00426311, -0.00405967, -0.00446238, -0.00443008, -0.00563403, -0.00503522, 
                   -0.0021715, -0.00230514, -0.00248226, -0.00267834, -0.00288916, -0.00311042, -0.00318613, -0.00364507, -0.00293496, -0.00382211, -0.00403803, -0.00518915, -0.00714356, 
                   -0.0014988, -0.00156828, -0.00166272, -0.00181909, -0.00187729, -0.001959, -0.00198986, -0.00196962, -0.00208177, -0.00236375, -0.00239139, -0.00299278, -0.00441029, 
                   -0.000859249, -0.000824273, -0.000820041, -0.000760974, -0.000775831, -0.000790416, -0.0007421, -0.000784922, -0.000631374, -0.000478637, -0.00054526, -0.000368912, 7.83117e-07, 
                   -0.000454934, -0.000381616, -0.000279872, -4.45224e-05, -2.28328e-06, 3.0527e-05, 7.96711e-05, 5.47124e-06, 0.000805618, 0.000239965, 0.00145464, 0.00268636, 0.00380997, 
                   -0.000332953, -0.000220014, 8.51957e-05, 0.000195551, 0.000278568, 0.000569233, 0.00106395, 0.000992105, 0.000775616, 0.00169571, 0.00258009, 0.00279034, 0.00290445, 
                   -0.000964987, -0.000765541, -0.000549087, -0.000497304, -0.000600912, -0.000480491, -0.000472403, -0.000123865, 4.39018e-05, 0.000290815, 0.00115513, 0.00119435, -0.0012419};
   const float SmearingTool::sig1MuPlus[104]={
                   0.0182917, 0.0189514, 0.0194592, 0.0201229, 0.0207266, 0.021352, 0.0209474, 0.0232806, 0.0212667, 0.0284568, 0.0302431, 0.0359819, 0.0491882, 
                   0.0172652, 0.0176861, 0.0181339, 0.0184641, 0.0186674, 0.0192382, 0.019309, 0.0201275, 0.020076, 0.0227977, 0.0247452, 0.0270864, 0.0387478, 
                   0.014313, 0.0144353, 0.0152128, 0.0154221, 0.0157943, 0.0161528, 0.0169105, 0.0171809, 0.0181942, 0.0179345, 0.0190412, 0.0257198, 0.0346622, 
                   0.00989054, 0.0102285, 0.0105748, 0.010929, 0.0112404, 0.0116451, 0.012115, 0.0123846, 0.0129168, 0.0135282, 0.0146298, 0.0174842, 0.0269379, 
                   0.0099326, 0.0102168, 0.0106483, 0.0110007, 0.0113655, 0.0117481, 0.011982, 0.0125808, 0.0131289, 0.0134748, 0.0150236, 0.0173824, 0.0283025, 
                   0.0143934, 0.014674, 0.0150881, 0.0155272, 0.0158897, 0.0163246, 0.0166855, 0.0170794, 0.0181968, 0.0177884, 0.0193599, 0.0270738, 0.0334595, 
                   0.0174216, 0.0177088, 0.0180205, 0.0183152, 0.0187564, 0.0190032, 0.0196899, 0.020029, 0.0200612, 0.0236283, 0.0246986, 0.0270992, 0.0357414, 
                   0.0183659, 0.0193051, 0.0197396, 0.0200311, 0.0206257, 0.0216685, 0.0223929, 0.0223895, 0.0220632, 0.0287698, 0.0314634, 0.0381788, 0.0515389};
   const float SmearingTool::sig2MuPlus[104]={
                   0.0342069, 0.0353088, 0.0365356, 0.0365301, 0.0377179, 0.0373103, 0.0372192, 0.0473507, 0.0366271, 3, 3, 3, 3, 
                   0.0341786, 0.034618, 0.0397922, 0.0369763, 0.037304, 0.041137, 0.0399666, 0.043826, 0.0409691, 3, 3, 3, 3, 
                   0.0304442, 0.0301129, 0.0340273, 0.032819, 0.0343206, 0.0359342, 0.0348724, 0.0332904, 0.0431669, 0.0392285, 0.0332718, 3, 3, 
                   0.0286418, 0.0286406, 0.0292917, 0.0296845, 0.0304554, 0.0319043, 0.0354337, 0.0350513, 0.0331079, 0.0336796, 0.0329142, 0.0385056, 3, 
                   0.0275741, 0.0284144, 0.0304489, 0.0301925, 0.0316294, 0.032157, 0.0320154, 0.0307697, 0.035023, 0.031875, 0.0366538, 0.0362244, 3, 
                   0.030041, 0.0300997, 0.0320453, 0.0331043, 0.033872, 0.0335895, 0.0348282, 0.0348547, 0.0392648, 0.0341965, 0.0390215, 3, 3, 
                   0.0363812, 0.0359973, 0.0379846, 0.0371373, 0.0387821, 0.0379849, 0.0401892, 0.0455582, 0.034222, 3, 3, 3, 3, 
                   0.0338463, 0.0357102, 0.0368247, 0.0348668, 0.0366105, 0.0383283, 0.0369434, 0.0399538, 0.0358783, 3, 3, 3, 3};
   const float SmearingTool::Asig2MuPlus[104]={
                   0.0952831, 0.0979908, 0.101649, 0.109607, 0.10832, 0.142052, 0.197932, 0.0753895, 0.340042, 0, 0, 0, 0, 
                   0.0508637, 0.0475258, 0.030417, 0.0444376, 0.0457321, 0.0312738, 0.0417573, 0.0342416, 0.0480447, 0, 0, 0, 0, 
                   0.0415206, 0.0486685, 0.0337294, 0.0444116, 0.041614, 0.0399949, 0.0452815, 0.0600042, 0.0271743, 0.0545995, 0.136127, 0, 0, 
                   0.0139668, 0.0148385, 0.0151355, 0.0155357, 0.0161485, 0.014321, 0.0119374, 0.0144108, 0.0172856, 0.0184905, 0.0309671, 0.0360646, 0, 
                   0.0159217, 0.0162339, 0.0146587, 0.016165, 0.0156317, 0.0161409, 0.0195316, 0.0219479, 0.0194841, 0.0285327, 0.022594, 0.0469062, 0, 
                   0.0456846, 0.0521082, 0.0489811, 0.0496115, 0.0498277, 0.052106, 0.0535689, 0.0629998, 0.0424204, 0.106774, 0.089618, 0, 0, 
                   0.0387597, 0.0436155, 0.0399261, 0.0513924, 0.0413785, 0.0477228, 0.0456537, 0.0268635, 0.0930395, 0, 0, 0, 0, 
                   0.108108, 0.0881693, 0.0955141, 0.152743, 0.14337, 0.129645, 0.180701, 0.183632, 0.4, 0, 0, 0, 0};

   const float SmearingTool::ERRmeanMuPlus[104]={
                   8.4794e-05, 7.92532e-05, 7.35743e-05, 6.62322e-05, 8.17629e-05, 0.000140264, 0.000208554, 0.000291515, 0.000376614, 0.000381016, 0.000459944, 0.000768818, 0.00286031, 
                   8.2697e-05, 7.4217e-05, 6.45039e-05, 5.68837e-05, 7.10767e-05, 0.00011738, 0.000172712, 0.000237889, 0.000300435, 0.000294019, 0.00035909, 0.000531057, 0.00171074, 
                   6.57756e-05, 5.66739e-05, 4.89757e-05, 4.53468e-05, 5.81409e-05, 9.4988e-05, 0.000142282, 0.000193431, 0.000252202, 0.000242251, 0.000288602, 0.000462187, 0.00132162, 
                   2.80276e-05, 2.40238e-05, 2.2036e-05, 2.14549e-05, 2.77945e-05, 4.53373e-05, 6.68048e-05, 9.08518e-05, 0.000118234, 0.000115301, 0.000139804, 0.000222784, 0.000699311, 
                   2.82589e-05, 2.40761e-05, 2.22021e-05, 2.16901e-05, 2.80936e-05, 4.58662e-05, 6.71804e-05, 9.27613e-05, 0.000122233, 0.000117893, 0.000140524, 0.000223732, 0.000708843, 
                   6.65046e-05, 5.76655e-05, 4.95394e-05, 4.61724e-05, 5.94063e-05, 9.67433e-05, 0.000142941, 0.000195093, 0.000254166, 0.00024695, 0.000295149, 0.000477624, 0.0013287, 
                   8.29611e-05, 7.46125e-05, 6.48408e-05, 5.72842e-05, 7.12156e-05, 0.000117534, 0.000175058, 0.000234705, 0.000306989, 0.000306826, 0.000358799, 0.000537357, 0.00159694, 
                   8.57388e-05, 7.97782e-05, 7.39064e-05, 6.71271e-05, 8.25447e-05, 0.000140818, 0.00021428, 0.000299812, 0.000390721, 0.000378397, 0.000465616, 0.00082554, 0.00308807};
   const float SmearingTool::ERRsig1MuPlus[104]={
                   0.000173074, 0.000166428, 0.000161747, 0.000156834, 0.000195503, 0.000389598, 0.000657381, 0.000730761, 0.00136212, 0.000274275, 0.00033518, 0.000596346, 0.00274159, 
                   0.000134425, 0.00012173, 9.46819e-05, 9.11251e-05, 0.000118915, 0.000176802, 0.000291417, 0.000404311, 0.000462544, 0.000208174, 0.000254946, 0.000379995, 0.00137958, 
                   9.20147e-05, 8.42594e-05, 6.61653e-05, 6.65699e-05, 8.15433e-05, 0.000137845, 0.000215833, 0.000349148, 0.000313101, 0.000417726, 0.000778669, 0.000329018, 0.00100924, 
                   2.86796e-05, 2.49844e-05, 2.28754e-05, 2.24995e-05, 2.91991e-05, 4.6139e-05, 6.76465e-05, 9.02735e-05, 0.000129833, 0.000132472, 0.000176628, 0.000310864, 0.000499773, 
                   2.97523e-05, 2.50495e-05, 2.26758e-05, 2.2611e-05, 2.88199e-05, 4.73995e-05, 7.23862e-05, 0.00010849, 0.000145079, 0.000146382, 0.000176453, 0.000337078, 0.000509337, 
                   9.97255e-05, 8.83529e-05, 7.30102e-05, 6.79819e-05, 8.96058e-05, 0.000152944, 0.000228113, 0.000342831, 0.000397338, 0.000490871, 0.000619397, 0.000341336, 0.000998139, 
                   0.00012481, 0.000119124, 9.79782e-05, 9.44679e-05, 0.000112666, 0.000201897, 0.000290912, 0.000308797, 0.000804925, 0.000217367, 0.000254625, 0.000384071, 0.00123326, 
                   0.000183294, 0.000166937, 0.000161836, 0.000180652, 0.00021473, 0.000371834, 0.000803688, 0.000899511, 0.000618245, 0.000272628, 0.000342414, 0.000659773, 0.00308136};
   const float SmearingTool::ERRsig2MuPlus[104]={
                   0.000982151, 0.00096699, 0.000944637, 0.000882299, 0.00116536, 0.00186067, 0.00229078, 0.00831351, 0.00297853, 0, 0, 0, 0, 
                   0.00124286, 0.00121569, 0.00153196, 0.00103733, 0.00133698, 0.00302428, 0.00386169, 0.00714793, 0.00588293, 0, 0, 0, 0, 
                   0.000861286, 0.000692178, 0.000781755, 0.000625487, 0.00084624, 0.00152679, 0.00217267, 0.00275942, 0.00631193, 0.00409291, 0.00325488, 0, 0, 
                   0.0005286, 0.00044334, 0.000406247, 0.000397555, 0.000508565, 0.000904136, 0.00163228, 0.00190953, 0.00235212, 0.00232698, 0.00219064, 0.00421085, 0, 
                   0.000494986, 0.000417822, 0.000418589, 0.000391735, 0.000526171, 0.000860139, 0.00114066, 0.00155442, 0.00245884, 0.00179184, 0.00295895, 0.0034745, 0, 
                   0.000850543, 0.000693467, 0.000619915, 0.00059178, 0.00079373, 0.00131969, 0.0019968, 0.0026127, 0.00486864, 0.0024998, 0.004267, 0, 0, 
                   0.00150049, 0.00130382, 0.00122426, 0.000950683, 0.00143809, 0.00224307, 0.00370782, 0.0071684, 0.00497744, 0, 0, 0, 0, 
                   0.000935724, 0.00108391, 0.00101425, 0.000738886, 0.000980039, 0.0020052, 0.00316208, 0.00382003, 0.000680424, 0, 0, 0, 0};
   const float SmearingTool::ERRAsig2MuPlus[104]={
                   0.0137877, 0.0133555, 0.012756, 0.0134759, 0.0165841, 0.0379406, 0.0656435, 0.0467443, 0.306919, 0, 0, 0, 0, 
                   0.00857898, 0.0078056, 0.00444766, 0.00543671, 0.00716107, 0.00868686, 0.0161396, 0.0197674, 0.0266001, 0, 0, 0, 0, 
                   0.00525594, 0.00514906, 0.00316636, 0.00369624, 0.00425671, 0.00678134, 0.0123157, 0.0241381, 0.0127106, 0.0219176, 0.0751604, 0, 0, 
                   0.000903525, 0.000825181, 0.000754298, 0.000757372, 0.00097305, 0.00142652, 0.00178179, 0.00255212, 0.00451773, 0.00481161, 0.00841626, 0.0149907, 0, 
                   0.00103857, 0.000855712, 0.000698187, 0.000749643, 0.000902906, 0.00150767, 0.00247415, 0.00436654, 0.00481596, 0.00638434, 0.00668869, 0.0188474, 0, 
                   0.00599874, 0.00563764, 0.00417561, 0.00382848, 0.00500745, 0.00918589, 0.0132944, 0.0211359, 0.0203198, 0.0377727, 0.0412875, 0, 0, 
                   0.00675289, 0.00693415, 0.0052092, 0.00564757, 0.00625125, 0.0121685, 0.0168409, 0.0133878, 0.0755913, 0, 0, 0, 0, 
                   0.0155121, 0.0133064, 0.0127657, 0.0183792, 0.0204085, 0.0346685, 0.0911345, 0.0863404, 0.295892, 0, 0, 0, 0};

   const float SmearingTool::ResRMSMuPlus[104]={
                   0.0213099, 0.0220666, 0.0227885, 0.0233702, 0.0240079, 0.0249752, 0.0257179, 0.026565, 0.0274252, 0.0283656, 0.0300421, 0.0350607, 0.0435811, 
                   0.0193215, 0.0195888, 0.0199328, 0.020434, 0.0206882, 0.0209819, 0.0213885, 0.0221256, 0.022352, 0.0227755, 0.0247121, 0.0270188, 0.0372094, 
                   0.016187, 0.0164783, 0.0171161, 0.0175298, 0.0179538, 0.0184124, 0.0189873, 0.0193884, 0.0201761, 0.0208931, 0.0223277, 0.0256861, 0.0339862, 
                   0.0111862, 0.0115086, 0.0118756, 0.0122235, 0.0126061, 0.0129486, 0.0134717, 0.0138782, 0.0143007, 0.0149177, 0.0163871, 0.0195592, 0.0268981, 
                   0.0112273, 0.0115778, 0.0120478, 0.0123944, 0.0128146, 0.0132096, 0.0136212, 0.0140388, 0.0148825, 0.0152491, 0.0167348, 0.0196254, 0.0281946, 
                   0.0163209, 0.016753, 0.0173373, 0.0178709, 0.0182847, 0.0186073, 0.0191579, 0.0197722, 0.020532, 0.0213048, 0.0230209, 0.0270405, 0.0329969, 
                   0.0193294, 0.0196959, 0.0200796, 0.0206236, 0.0207921, 0.0211171, 0.0218726, 0.0218024, 0.0223902, 0.0236302, 0.0246712, 0.0270539, 0.0349526, 
                   0.0215619, 0.0221421, 0.0228763, 0.0236964, 0.0243992, 0.0252036, 0.0261007, 0.0270934, 0.0278677, 0.0286867, 0.0311945, 0.0368577, 0.0446802};
   const float SmearingTool::ErrResRMSMuPlus[104]={
                   6.17752e-05, 5.75529e-05, 5.34756e-05, 4.78058e-05, 5.88589e-05, 0.00010055, 0.00015001, 0.000207337, 0.000269575, 0.000267696, 0.00032109, 0.000516046, 0.00158713, 
                   6.01731e-05, 5.37707e-05, 4.68825e-05, 4.11997e-05, 5.14849e-05, 8.47341e-05, 0.000125188, 0.000171821, 0.000217492, 0.000207668, 0.000253434, 0.000373822, 0.00111483, 
                   4.85185e-05, 4.18357e-05, 3.61678e-05, 3.34525e-05, 4.29624e-05, 7.02917e-05, 0.000103978, 0.000140836, 0.000184737, 0.000179328, 0.00020857, 0.000326057, 0.000896862, 
                   2.12646e-05, 1.81316e-05, 1.66011e-05, 1.61009e-05, 2.0883e-05, 3.39409e-05, 5.01282e-05, 6.83563e-05, 8.78285e-05, 8.51954e-05, 0.00010309, 0.000163243, 0.0004929, 
                   2.13648e-05, 1.82374e-05, 1.68353e-05, 1.6356e-05, 2.12135e-05, 3.45278e-05, 5.07295e-05, 6.88854e-05, 9.19443e-05, 8.78213e-05, 0.000104065, 0.000163978, 0.000497948, 
                   4.89717e-05, 4.25092e-05, 3.66871e-05, 3.42086e-05, 4.39453e-05, 7.1068e-05, 0.00010539, 0.000143359, 0.000185523, 0.000181477, 0.000216524, 0.000336745, 0.000913064, 
                   6.03795e-05, 5.42398e-05, 4.7286e-05, 4.17507e-05, 5.16741e-05, 8.4929e-05, 0.000126683, 0.000169629, 0.000219681, 0.000216928, 0.000253307, 0.000378681, 0.00107866, 
                   6.25639e-05, 5.78278e-05, 5.3623e-05, 4.84709e-05, 5.95861e-05, 0.00010097, 0.000152341, 0.000214663, 0.000276365, 0.000265914, 0.00032375, 0.00054391, 0.00164026};

   ////// End smearing parametrization for single muon plus:

SmearingTool::SmearingTool(){
}
float SmearingTool::PTsmear(float PTmuonGen, float ETAmuonGen, float CHARGEmuonGen, float PTmuonReco, int Ismear, TString ParVar,float ParSig){
   //Ismear = 1 - Smear with RND (no RECO use), Ismear = 2 - Smear with SF for RECO and GEN
   if(Ismear != 1 && Ismear != 2)std::cout << "ERROR SmearingTool::PTsmear: set Ismear to 1 or 2 for smearing" << std::endl;
   const int NPThist = (sizeof(PTbin)/sizeof(float)-1);
   const int NETAhist = (sizeof(ETAbin)/sizeof(float)-1);
   //const int Nhist = NPThist*NETAhist;
   ////// Make smearing for single muon from Gen level PostFSR:
   float PTmuonSmear = -10.;
   float meanVar = 0;
   float sigVar = 0;//for sig1 and sig2
   float Asig2Var = 0;
   if(ParVar == "mean")meanVar = ParSig;
   if(ParVar == "sig1" || ParVar == "sig2")sigVar = ParSig;
   if(ParVar == "Asig2Var")Asig2Var = ParSig;
   int iK_cand = -1;
   for(int iPT = 0; iPT < NPThist; iPT++){
   for(int iETA = 0; iETA < NETAhist; iETA++){
      int iK = iPT + iETA*NPThist;
      // smear muons which out of range PT and ETA
      float PTcutDown = PTbin[iPT];
      float PTcutUp = PTbin[iPT+1];
      if(iPT == 0 && PTmuonGen < PTbin[0])PTcutDown = PTmuonGen-0.001;
      if(iPT == (NPThist-1) && PTmuonGen > PTbin[NPThist])PTcutUp = PTmuonGen+0.001;
      float ETAcutDown = ETAbin[iETA];
      float ETAcutUp = ETAbin[iETA+1];
      if(iETA == 0 && ETAmuonGen < ETAbin[0])ETAcutDown = ETAmuonGen-0.001;
      if(iETA == (NETAhist-1) && ETAmuonGen >= ETAbin[NETAhist])ETAcutUp = ETAmuonGen+0.001;
      if(PTmuonGen >= PTcutDown && PTmuonGen < PTcutUp
      && ETAmuonGen >= ETAcutDown && ETAmuonGen < ETAcutUp) iK_cand = iK;
   }}

   ///// Set Scale Factor
   float ScaleFactor = 1.;
   if (fabs(ETAmuonGen) < 0.8) ScaleFactor = 1.01;
   if (fabs(ETAmuonGen) >= 0.8 && fabs(ETAmuonGen) < 1.2) ScaleFactor = 1.07;
   if (fabs(ETAmuonGen) >= 1.2) ScaleFactor = 1.08;
   TF1* fitDoubleGauss = new TF1("fitDoubleGauss", DoubleGauss, -0.1, 0.1, 5);
   fitDoubleGauss->SetParameter(4,1.);
   if(iK_cand > -1 && Ismear == 1 && CHARGEmuonGen < 0){
      float meanCorr = mean[iK_cand] + meanVar*ERRmean[iK_cand];
      float sig1Corr = sig1[iK_cand] + sigVar*ERRsig1[iK_cand];
      if(sig1Corr < 0.005) sig1Corr = 0.005;
      float sig2Corr = sig2[iK_cand] + sigVar*ERRsig2[iK_cand];
      if(sig2Corr < 0.005) sig2Corr = 0.005;
      float Asig2Corr = Asig2[iK_cand] + Asig2Var*ERRAsig2[iK_cand];
      if(Asig2Corr < 0.) Asig2Corr = 0.;
      fitDoubleGauss->SetParameter(0,meanCorr);
      fitDoubleGauss->SetParameter(1,ScaleFactor*sig1Corr);
      fitDoubleGauss->SetParameter(2,Asig2Corr);
      fitDoubleGauss->SetParameter(3,ScaleFactor*sig2Corr);
      Double_t resSim = fitDoubleGauss->GetRandom();
      PTmuonSmear = PTmuonGen*(1+resSim);
   }
   if(iK_cand > -1 && Ismear == 1 && CHARGEmuonGen > 0){
      float meanCorr = meanMuPlus[iK_cand] + meanVar*ERRmeanMuPlus[iK_cand];
      float sig1Corr = sig1MuPlus[iK_cand] + sigVar*ERRsig1MuPlus[iK_cand];
      if(sig1Corr < 0.005) sig1Corr = 0.005;
      float sig2Corr = sig2MuPlus[iK_cand] + sigVar*ERRsig2MuPlus[iK_cand];
      if(sig2Corr < 0.005) sig2Corr = 0.005;
      float Asig2Corr = Asig2MuPlus[iK_cand] + Asig2Var*ERRAsig2MuPlus[iK_cand];
      if(Asig2Corr < 0.) Asig2Corr = 0.;
      fitDoubleGauss->SetParameter(0,meanCorr);
      fitDoubleGauss->SetParameter(1,ScaleFactor*sig1Corr);
      fitDoubleGauss->SetParameter(2,Asig2Corr);
      fitDoubleGauss->SetParameter(3,ScaleFactor*sig2Corr);
      Double_t resSim = fitDoubleGauss->GetRandom();
      PTmuonSmear = PTmuonGen*(1+resSim);
   }
   delete fitDoubleGauss;
   if(iK_cand > -1 && Ismear == 2){
      PTmuonSmear = PTmuonGen + ScaleFactor*(PTmuonReco - PTmuonGen);
   }
   ////// End Smearing parametrization for single muon:

   return PTmuonSmear;
 }//end PTsmear function

   Double_t DoubleGauss(Double_t *x, Double_t *par)
   {
       double dgauss = 0.;
        if(par[1] < par[3]){//not normalized gauss both gauss are  = 1 at x[0]=par[0]
                  dgauss =  exp(-0.5*(x[0]-par[0])*(x[0]-par[0])/par[1]/par[1]);
                  dgauss = dgauss + par[2]*exp(-0.5*(x[0]-par[0])*(x[0]-par[0])/par[3]/par[3]);
                  dgauss = par[4]*dgauss;
        }
       return dgauss;
   }
